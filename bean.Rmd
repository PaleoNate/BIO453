---
title: "The bean experiment"
description: adapted from an exercise by Barry Sinervo
date: "`r Sys.Date()`"
output: distill::distill_article
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```
 
Picture yourself as an early farmer 9000 years ago planting a field of beans. You have your beans in a leather pouch hanging at your side, you reach in, grab a few beans letting them filter through your fingers until you have a single bean which you drop into a hole you have just
made with your staff. You cover that hole with your foot and thm move a few feet further down the row and poke another hole in the ground for the next seed.  

Now, you are not consiously doing anything to improve your crop. You are not selecting beans of a particular type or size. You simply have a pouch of beans that you are planting. Given this assumption, what do you predict would be the pattern of the bean size over time? Do you expect the beans you have at the beginning of your planting season to be the same size as the beans you have at the end of your planting season? If, not, how do you expect them to differ? If you do not thing your remaining beans are a random subset of your starting beans, what is the basis for your expectation? Make null and alternative hypotheses for the pattern of bean size over time.

## Part 1

Get a bag of approximately 200 beans.  

Reach into the bag and pick up approximately 5-10 beans with our fingers and roll them around with your fingers until you have only 1. Set this bean aside in "lot 1". Repeat this procedure until there are 10 beans in "lot 1". Place these beans in a weighing boat labeled lot 1.   

Create 20 such lots in sequence, weigh each lot, and divide by the number of beans to get the mean weight of beans in each lot. Record your data in a table. Your table should have a column for "lot" and a column for "trial1_weights" in an excel file called "bean_data.xlsx".

## Part 2

Spread your bean boats on the table in front you and dump them out. Now play the part of the farmer purposefully trying to improve the crop by selecting the largest beans to plant first. How does this change your expectation of the pattern of bean size over time?  Sort your beans into lots with your preferred beans in the earliest lots and your least preferred beans in your later lots. Reweigh your lots and record your data in a new column called "trial2_weights".

## Part 3

Load necessary packages for your data analysis

```{r}
library(readxl)
library(ggplot2)
library(ggpmisc)
library(see)
library(patchwork)
library(performance)
```

Read in your data file

```{r}
# Load data

#data <- read_excel(file.choose())
#data <- read_excel("bean_data.xlsx")

# Create the lot numbers
lot <- seq(1:20)

# Create trial 1 weights
trial1_weights <- c(1.2, 1.1, 0.9, 1, 0.9, 0.85, 0.9, 0.7, 0.75, 0.8, 
                    0.7, 0.65, 0.6, 0.65, 0.6, 0.57, 0.5, 0.55, 0.5, 0.5)

# Create trial 2 weights
trial2_weights <- c(1.2, 1.1, 1, 0.9, 0.9, 0.9, 0.85, 0.8, 0.75, 0.7, 
                    0.7, 0.65, 0.65, 0.6, 0.6, 0.57, 0.55, 0.5, 0.5, 0.5)

# Combine into a dataframe
mydata <- data.frame(lot = lot, 
                   trial1_weights, 
                   trial2_weights)
```

Plot your data

```{r}
# Plot trial 1 weights against lot number
# Create the plot without stat_regline_equation
plot_trial1 <- ggplot(mydata, aes(x = lot, y = `trial1_weights`)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  labs(title = "Trial 1 Weights vs. Lot Number",
       x = "Lot Number",
       y = "Trial 1 Weights")

# Fit linear regression outside of ggplot
lm_model <- lm(`trial1_weights` ~ lot, data = mydata)
```

Before moving on, lets consider whether a linear regression was appropriate for these data by checking the questions generated below.

```{r}
# Check model assumptions
check_model(x=lm_model, check="normality")
check_model(x=lm_model, check="linearity")
check_model(x=lm_model, check="homogeneity")
check_model(x=lm_model, check="outliers")
```

Now lets look at the model output

```{r}
#evaluate the linear model
summary(lm_model)
```

Is the slope of the regression line through the data from your first trial non-zero? Is it *significantly* different from zero at the alpha=0.05 level? Do we reject or fail to reject your null hypothesis? 


Okay, now lets look at the plot below. How can you explain this pattern light of your alternative hypothesis? Don't forget to report the linear equation, the $r^2$ value, and the p-value for each regression.

```{r}
# Extract coefficients
intercept <- coef(lm_model)[1]
slope <- coef(lm_model)[2]

# Create equation text
equation_text <- paste("y =", round(intercept, 2), "+", round(slope, 2), "x")

# Add equation annotation to the plot
plot_trial1 <- plot_trial1 +
  annotate("text", x = max(mydata$lot), y = max(mydata$trial1_weights), 
           label = equation_text, hjust = 1, vjust = 1)

# Plot trial 2 weights against lot number
plot_trial2 <- ggplot(mydata, aes(x = lot, y = `trial2_weights`)) +
  geom_point() +
  labs(title = "Trial 2 Weights vs. Lot Number",
       x = "Lot Number",
       y = "Trial 2 Weights")

# Display plots
plot_trial1
plot_trial2
```

## The lab report

Your lab report should begin with a brief review of the literature about evolution of seed size during the early stages of agriculture. I ahve provided two sources to get you started (Darwin 1859 Ch. 4; Heiser, 1988, and Smith 2006). 

Read these and structure an introduction that sets up a test of the hypothesis that unconscious selection for bean size exists based on your data and the class data.  

Describe your methods in sufficient detail tat you could give them to another student and the would be able to replicate the experiment and statistical analysis of the data.  

Describe your results and refer to your figures.

Write a discussion that begins with an assessment of unconscious selection as a driver of the evolution of seed size in early agriculture. Then, consider how selection might drive the evolution of seed size in other ecological contexts and propose future investigations.  

Learn more about using Distill for R Markdown at <https://rstudio.github.io/distill>.





